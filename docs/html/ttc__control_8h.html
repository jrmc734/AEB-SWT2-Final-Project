<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AEB Controller: inc/ttc_control.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AEB Controller
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bfccd401955b95cf8c75461437045ac0.html">inc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ttc_control.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for ttc_control.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="ttc__control_8h__incl.png" border="0" usemap="#ainc_2ttc__control_8h" alt=""/></div>
<map name="ainc_2ttc__control_8h" id="ainc_2ttc__control_8h">
<area shape="rect" title=" " alt="" coords="67,5,193,32"/>
<area shape="rect" title=" " alt="" coords="5,80,73,107"/>
<area shape="rect" title=" " alt="" coords="98,80,162,107"/>
<area shape="rect" title=" " alt="" coords="186,80,269,107"/>
</map>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="ttc__control_8h__dep__incl.png" border="0" usemap="#ainc_2ttc__control_8hdep" alt=""/></div>
<map name="ainc_2ttc__control_8hdep" id="ainc_2ttc__control_8hdep">
<area shape="rect" title=" " alt="" coords="75,5,202,32"/>
<area shape="rect" href="ttc__control_8c.html" title=" " alt="" coords="5,80,131,107"/>
<area shape="rect" href="test__ttc_8c.html" title=" " alt="" coords="155,80,266,107"/>
</map>
</div>
</div>
<p><a href="ttc__control_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a48b709ab38f0019afe1d01374488b9dc"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ttc__control_8h.html#a48b709ab38f0019afe1d01374488b9dc">accel_calc</a> (float spd)</td></tr>
<tr class="memdesc:a48b709ab38f0019afe1d01374488b9dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate acceleration based on speed and time difference.  <a href="ttc__control_8h.html#a48b709ab38f0019afe1d01374488b9dc">More...</a><br /></td></tr>
<tr class="separator:a48b709ab38f0019afe1d01374488b9dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d764fb657999d51ee365fbaa4214d06"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ttc__control_8h.html#a3d764fb657999d51ee365fbaa4214d06">ttc_calc</a> (float dist, float spd)</td></tr>
<tr class="memdesc:a3d764fb657999d51ee365fbaa4214d06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the time to collision (TTC) based on relative distance and speed.  <a href="ttc__control_8h.html#a3d764fb657999d51ee365fbaa4214d06">More...</a><br /></td></tr>
<tr class="separator:a3d764fb657999d51ee365fbaa4214d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9680218967729532a9eb469cfdb3ae4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ttc__control_8h.html#ad9680218967729532a9eb469cfdb3ae4">aeb_control</a> (bool *enable_aeb, bool *alarm_cluster, bool *enable_breaking, bool *lk_seatbelt, bool *lk_doors, float *spd, float *dist)</td></tr>
<tr class="memdesc:ad9680218967729532a9eb469cfdb3ae4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Controls the Autonomous Emergency Braking (AEB) system.  <a href="ttc__control_8h.html#ad9680218967729532a9eb469cfdb3ae4">More...</a><br /></td></tr>
<tr class="separator:ad9680218967729532a9eb469cfdb3ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a48b709ab38f0019afe1d01374488b9dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48b709ab38f0019afe1d01374488b9dc">&#9670;&nbsp;</a></span>accel_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float accel_calc </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>spd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate acceleration based on speed and time difference. </p>
<p>This function calculates the acceleration in m/s² based on the difference in speed and time. It uses the <code>clock_gettime</code> function to measure the time difference between consecutive calls and calculates acceleration as the change in speed divided by the elapsed time [SwR-11].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spd</td><td>Current speed in km/h.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The acceleration in m/s². If the function is called for the first time or there is insufficient time difference between calls, it returns 0.0. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ttc__control_8c_source.html#l00017">17</a> of file <a class="el" href="ttc__control_8c_source.html">ttc_control.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                            {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">float</span> prev_spd = 0.0;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">static</span> <span class="keyword">struct </span>timespec start_time = {0, 0};</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keyword">struct </span>timespec current_time;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">double</span> elapsed_time;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">float</span> accel = 0.0;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    clock_gettime(CLOCK_REALTIME, &amp;current_time);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (prev_spd == 0.0) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        prev_spd = spd;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        start_time = current_time;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        elapsed_time = (double)(current_time.tv_sec - start_time.tv_sec) </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                        + (double)(current_time.tv_nsec - start_time.tv_nsec) / 1e9;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="keywordflow">if</span> (elapsed_time &lt; 0.01) <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        accel = ((spd - prev_spd) / 3.6) / elapsed_time;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        start_time = current_time;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        prev_spd = spd;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">return</span> accel;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    } </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9680218967729532a9eb469cfdb3ae4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9680218967729532a9eb469cfdb3ae4">&#9670;&nbsp;</a></span>aeb_control()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void aeb_control </td>
          <td>(</td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>enable_aeb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>alarm_cluster</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>enable_breaking</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>lk_seatbelt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>lk_doors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>spd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Controls the Autonomous Emergency Braking (AEB) system. </p>
<p>This function calculates the Time to Collision (TTC) based on the relative distance and speed of the vehicle. If the TTC is below a certain threshold, the AEB system triggers the alarm and may engage the braking system. It also prepares other safety features like seatbelt locking and door unlocking in critical conditions.</p>
<p>The decision is made based on predefined TTC thresholds:</p><ul>
<li>If the TTC is below the <code>THRESHOLD_ALARM</code> (e.g., 2 seconds), an alarm is triggered.</li>
<li>If the TTC is below the <code>THRESHOLD_BRAKING</code> (e.g., 1 second), the braking system is activated.</li>
<li>If the TTC is less than half of the braking threshold, the braking system is prepared for a collision.</li>
</ul>
<p>The AEB system and the alarm are only triggered if the <code>enable_aeb</code> flag is set to true.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">enable_aeb</td><td>A pointer to a boolean flag that enables or disables the AEB system. [SwR-5] </td></tr>
    <tr><td class="paramname">alarm_cluster</td><td>A pointer to a boolean flag that triggers the alarm in the cluster. [SwR-2] </td></tr>
    <tr><td class="paramname">enable_breaking</td><td>A pointer to a boolean flag that enables or disables the braking system. [SwR-3] </td></tr>
    <tr><td class="paramname">lk_seatbelt</td><td>A pointer to a boolean flag that locks the seatbelt in case of emergency. [Sys-F-14] </td></tr>
    <tr><td class="paramname">lk_doors</td><td>A pointer to a boolean flag that locks or unlocks the doors in an emergency. [Sys-F-14] </td></tr>
    <tr><td class="paramname">spd</td><td>A pointer to the current speed of the vehicle (in km/h). </td></tr>
    <tr><td class="paramname">dist</td><td>A pointer to the current distance to the obstacle (in meters).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The function complies with the requirements (SwR-2, SwR-3, SwR-5, SwR-11, SwR-14, SwR-15, Sys-F-8, Sys-F-9, Sys-F-14). </dd></dl>

<p class="definition">Definition at line <a class="el" href="ttc__control_8c_source.html#l00107">107</a> of file <a class="el" href="ttc__control_8c_source.html">ttc_control.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                                                             {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">float</span> ttc;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    ttc = <a class="code" href="ttc__control_8c.html#a0cc178c96e646a5361f34b3e9835e676">ttc_calc</a>(*dist, *spd);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> ((*enable_aeb) &amp;&amp; (ttc &gt; 0.0) &amp;&amp; (ttc &lt; <a class="code" href="constants_8h.html#af914e188aab1d10dc995ba2938e0b691">THRESHOLD_ALARM</a>)) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        *alarm_cluster = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">if</span> ((ttc &lt; <a class="code" href="constants_8h.html#a54bb76eeda8e1910c30bab2500d91325">THRESHOLD_BRAKING</a>) &amp;&amp; (!*enable_breaking) &amp;&amp; (*spd &lt; <a class="code" href="constants_8h.html#ad6212b1ad0c34c6212ec01d5aa81005b">MAX_SPD_ENABLED</a>)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            &amp;&amp; (*spd &gt; <a class="code" href="constants_8h.html#a3f02e1e1a9f7e4eeba4cac6cfe6e18b1">MIN_SPD_ENABLED</a>)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            *enable_breaking = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span> (ttc &lt; (<a class="code" href="constants_8h.html#a54bb76eeda8e1910c30bab2500d91325">THRESHOLD_BRAKING</a> / 2.0)) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                *lk_seatbelt = <span class="keyword">true</span>;  </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                *lk_doors = <span class="keyword">false</span>;    </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        }       </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        *alarm_cluster = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        *enable_breaking = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="ttc" id="aconstants_8h_html_a3f02e1e1a9f7e4eeba4cac6cfe6e18b1"><div class="ttname"><a href="constants_8h.html#a3f02e1e1a9f7e4eeba4cac6cfe6e18b1">MIN_SPD_ENABLED</a></div><div class="ttdeci">#define MIN_SPD_ENABLED</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00019">constants.h:19</a></div></div>
<div class="ttc" id="aconstants_8h_html_a54bb76eeda8e1910c30bab2500d91325"><div class="ttname"><a href="constants_8h.html#a54bb76eeda8e1910c30bab2500d91325">THRESHOLD_BRAKING</a></div><div class="ttdeci">#define THRESHOLD_BRAKING</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00017">constants.h:17</a></div></div>
<div class="ttc" id="aconstants_8h_html_ad6212b1ad0c34c6212ec01d5aa81005b"><div class="ttname"><a href="constants_8h.html#ad6212b1ad0c34c6212ec01d5aa81005b">MAX_SPD_ENABLED</a></div><div class="ttdeci">#define MAX_SPD_ENABLED</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00018">constants.h:18</a></div></div>
<div class="ttc" id="aconstants_8h_html_af914e188aab1d10dc995ba2938e0b691"><div class="ttname"><a href="constants_8h.html#af914e188aab1d10dc995ba2938e0b691">THRESHOLD_ALARM</a></div><div class="ttdeci">#define THRESHOLD_ALARM</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00016">constants.h:16</a></div></div>
<div class="ttc" id="attc__control_8c_html_a0cc178c96e646a5361f34b3e9835e676"><div class="ttname"><a href="ttc__control_8c.html#a0cc178c96e646a5361f34b3e9835e676">ttc_calc</a></div><div class="ttdeci">float ttc_calc(float dis_rel, float spd_rel)</div><div class="ttdoc">Calculate the time to collision (TTC) based on relative distance and speed.</div><div class="ttdef"><b>Definition:</b> <a href="ttc__control_8c_source.html#l00060">ttc_control.c:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d764fb657999d51ee365fbaa4214d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d764fb657999d51ee365fbaa4214d06">&#9670;&nbsp;</a></span>ttc_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ttc_calc </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>dis_rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>spd_rel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the time to collision (TTC) based on relative distance and speed. </p>
<p>This function calculates the time to collision using the Uniformly Variable Motion (UVM) model. It uses a quadratic equation to calculate the time to collision (TTC) between two objects based on their relative distance and speed. If the relative acceleration is zero, the function simply calculates the time by dividing the relative distance by the relative speed [SwR-1], [SwR-10], [SwR-11].</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dis_rel</td><td>The relative distance between the objects in meters. </td></tr>
    <tr><td class="paramname">spd_rel</td><td>The relative speed between the objects in km/h.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The time to collision in seconds. If no real solution is found (i.e., negative discriminant), the function returns -1.0. If there is no relative acceleration, the time to collision is calculated as distance divided by speed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ttc__control_8c_source.html#l00060">60</a> of file <a class="el" href="ttc__control_8c_source.html">ttc_control.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                             {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">float</span> a, b, c, ttc, delta;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    a = <a class="code" href="ttc__control_8c.html#a48b709ab38f0019afe1d01374488b9dc">accel_calc</a>(spd_rel);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    b = spd_rel / 3.6;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    c = dis_rel;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (a == 0) <span class="keywordflow">return</span> ttc = c / b;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    delta = b * b + 2 * a * c;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (delta &lt; 0) <span class="keywordflow">return</span> -1.0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (delta == 0) <span class="keywordflow">return</span> -b / a;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        ttc = (-b + sqrt(delta)) / a;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">return</span> ttc;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="ttc" id="attc__control_8c_html_a48b709ab38f0019afe1d01374488b9dc"><div class="ttname"><a href="ttc__control_8c.html#a48b709ab38f0019afe1d01374488b9dc">accel_calc</a></div><div class="ttdeci">float accel_calc(float spd)</div><div class="ttdoc">Calculate acceleration based on speed and time difference.</div><div class="ttdef"><b>Definition:</b> <a href="ttc__control_8c_source.html#l00017">ttc_control.c:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
