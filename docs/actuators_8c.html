<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AEB Controller: src/actuators.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AEB Controller
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">actuators.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;mqueue.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;pthread.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mq__utils_8h_source.html">mq_utils.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="constants_8h_source.html">constants.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="actuators_8h_source.html">actuators.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dbc_8h_source.html">dbc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="log__utils_8h_source.html">log_utils.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for actuators.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="actuators_8c__incl.png" border="0" usemap="#asrc_2actuators_8c" alt=""/></div>
<map name="asrc_2actuators_8c" id="asrc_2actuators_8c">
<area shape="rect" title=" " alt="" coords="367,5,485,32"/>
<area shape="rect" title=" " alt="" coords="231,155,298,181"/>
<area shape="rect" title=" " alt="" coords="515,80,585,107"/>
<area shape="rect" title=" " alt="" coords="610,80,685,107"/>
<area shape="rect" title=" " alt="" coords="5,155,92,181"/>
<area shape="rect" title=" " alt="" coords="422,229,505,256"/>
<area shape="rect" title=" " alt="" coords="709,80,793,107"/>
<area shape="rect" href="mq__utils_8h.html" title=" " alt="" coords="73,80,163,107"/>
<area shape="rect" href="dbc_8h.html" title="Defines CAN message identifiers, calibration values, and resolution factors based on the DBC specific..." alt="" coords="203,229,260,256"/>
<area shape="rect" href="constants_8h.html" title="Defines constants and calibration values for the AEB system." alt="" coords="817,80,915,107"/>
<area shape="rect" href="actuators_8h.html" title=" " alt="" coords="373,155,468,181"/>
<area shape="rect" href="log__utils_8h.html" title=" " alt="" coords="299,80,388,107"/>
<area shape="rect" title=" " alt="" coords="229,304,300,331"/>
</map>
</div>
</div>
<p><a href="actuators_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab0b4f8f98c3eb2f7041948c148ceadf8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#ab0b4f8f98c3eb2f7041948c148ceadf8">LOOP_EMPTY_ITERATIONS_MAX</a>&#160;&#160;&#160;11</td></tr>
<tr class="separator:ab0b4f8f98c3eb2f7041948c148ceadf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2e65ffc061b664d39102b09c560ac7a3"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#a2e65ffc061b664d39102b09c560ac7a3">actuatorsResponseLoop</a> (void *arg)</td></tr>
<tr class="memdesc:a2e65ffc061b664d39102b09c560ac7a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main loop for processing actuator messages.  <a href="actuators_8c.html#a2e65ffc061b664d39102b09c560ac7a3">More...</a><br /></td></tr>
<tr class="separator:a2e65ffc061b664d39102b09c560ac7a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a808bc89bdef3d1eb623c526be876d3d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#a808bc89bdef3d1eb623c526be876d3d8">actuatorsTranslateCanMsg</a> (<a class="el" href="structcan__msg.html">can_msg</a> captured_frame)</td></tr>
<tr class="separator:a808bc89bdef3d1eb623c526be876d3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8636c5193582ea95742cd24349cf3aa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#a8636c5193582ea95742cd24349cf3aa2">updateInternalActuatorsState</a> (<a class="el" href="structcan__msg.html">can_msg</a> captured_frame)</td></tr>
<tr class="separator:a8636c5193582ea95742cd24349cf3aa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a888ff70e2de4c8fbaedc5134dbe2a441"><td class="memItemLeft" align="right" valign="top">mqd_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#a888ff70e2de4c8fbaedc5134dbe2a441">actuators_mq</a></td></tr>
<tr class="separator:a888ff70e2de4c8fbaedc5134dbe2a441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b5d6738ab4914747667d9407905730"><td class="memItemLeft" align="right" valign="top">pthread_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#ac6b5d6738ab4914747667d9407905730">actuators_id</a></td></tr>
<tr class="separator:ac6b5d6738ab4914747667d9407905730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab919c9cf0d6de1c30bb90ee5636f09b8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structactuators__abstraction.html">actuators_abstraction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a></td></tr>
<tr class="separator:ab919c9cf0d6de1c30bb90ee5636f09b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d2051893d3d3ea4e0dcc3c647770c95"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structcan__msg.html">can_msg</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="actuators_8c.html#a5d2051893d3d3ea4e0dcc3c647770c95">captured_can_frame</a></td></tr>
<tr class="separator:a5d2051893d3d3ea4e0dcc3c647770c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab0b4f8f98c3eb2f7041948c148ceadf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0b4f8f98c3eb2f7041948c148ceadf8">&#9670;&nbsp;</a></span>LOOP_EMPTY_ITERATIONS_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOOP_EMPTY_ITERATIONS_MAX&#160;&#160;&#160;11</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00022">22</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2e65ffc061b664d39102b09c560ac7a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e65ffc061b664d39102b09c560ac7a3">&#9670;&nbsp;</a></span>actuatorsResponseLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * actuatorsResponseLoop </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main loop for processing actuator messages. </p>
<p>This function runs in a separate thread and continuously reads messages from the actuators message queue. It processes each message to update the internal state of the actuators and logs the event. If the message queue is empty for a specified number of iterations (<code>LOOP_EMPTY_ITERATIONS_MAX</code>), the loop exits, signaling that no more messages are expected.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>Unused parameter (can be NULL). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NULL</dd></dl>
<ul>
<li>Reads messages from the <code>actuators_mq</code> message queue using <code>read_mq</code>.</li>
<li>If a message is successfully read, it resets the <code>empty_mq_counter</code> and processes the message using <code>actuatorsTranslateCanMsg</code>.</li>
<li>If the queue is empty, increments the <code>empty_mq_counter</code>.</li>
<li>Logs each processed message using <code>log_event</code>, including the current state of the actuators.</li>
<li>Waits for 200 milliseconds between iterations using <code>usleep</code>.</li>
<li>Exits the loop and prints a message when the <code>empty_mq_counter</code> reaches <code>LOOP_EMPTY_ITERATIONS_MAX</code>.</li>
</ul>
<p>Implements <a class="el" href="software_requirements.html#SwR-4">SwR-4</a> </p>

<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00092">92</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">int</span> empty_mq_counter = 0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">while</span> (empty_mq_counter &lt; <a class="code" href="actuators_8c.html#ab0b4f8f98c3eb2f7041948c148ceadf8">LOOP_EMPTY_ITERATIONS_MAX</a>)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="mq__utils_8c.html#abee084f2648925ba92404d2d06f98581">read_mq</a>(<a class="code" href="actuators_8c.html#a888ff70e2de4c8fbaedc5134dbe2a441">actuators_mq</a>, &amp;<a class="code" href="actuators_8c.html#a5d2051893d3d3ea4e0dcc3c647770c95">captured_can_frame</a>) != -1)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            empty_mq_counter = 0;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <a class="code" href="actuators_8c.html#a808bc89bdef3d1eb623c526be876d3d8">actuatorsTranslateCanMsg</a>(<a class="code" href="actuators_8c.html#a5d2051893d3d3ea4e0dcc3c647770c95">captured_can_frame</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            empty_mq_counter++;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        uint32_t event_id = <a class="code" href="actuators_8c.html#a5d2051893d3d3ea4e0dcc3c647770c95">captured_can_frame</a>.<a class="code" href="structcan__msg.html#ac4e36d6ad06dd50743b62e7414f78184">identifier</a>; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="log__utils_8c.html#acf303e3f3f7d320a1113be573509bb63">log_event</a>(<span class="stringliteral">&quot;AEB1&quot;</span>, event_id, <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>); <span class="comment">// [SwR-4]</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        usleep(200000); <span class="comment">// Deprected, change for function other later</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    printf(<span class="stringliteral">&quot;Actuators: empty_mq_counter reached the limit, exiting\n&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="ttc" id="aactuators_8c_html_a5d2051893d3d3ea4e0dcc3c647770c95"><div class="ttname"><a href="actuators_8c.html#a5d2051893d3d3ea4e0dcc3c647770c95">captured_can_frame</a></div><div class="ttdeci">can_msg captured_can_frame</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8c_source.html#l00038">actuators.c:38</a></div></div>
<div class="ttc" id="aactuators_8c_html_a808bc89bdef3d1eb623c526be876d3d8"><div class="ttname"><a href="actuators_8c.html#a808bc89bdef3d1eb623c526be876d3d8">actuatorsTranslateCanMsg</a></div><div class="ttdeci">void actuatorsTranslateCanMsg(can_msg captured_frame)</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8c_source.html#l00119">actuators.c:119</a></div></div>
<div class="ttc" id="aactuators_8c_html_a888ff70e2de4c8fbaedc5134dbe2a441"><div class="ttname"><a href="actuators_8c.html#a888ff70e2de4c8fbaedc5134dbe2a441">actuators_mq</a></div><div class="ttdeci">mqd_t actuators_mq</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8c_source.html#l00028">actuators.c:28</a></div></div>
<div class="ttc" id="aactuators_8c_html_ab0b4f8f98c3eb2f7041948c148ceadf8"><div class="ttname"><a href="actuators_8c.html#ab0b4f8f98c3eb2f7041948c148ceadf8">LOOP_EMPTY_ITERATIONS_MAX</a></div><div class="ttdeci">#define LOOP_EMPTY_ITERATIONS_MAX</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8c_source.html#l00022">actuators.c:22</a></div></div>
<div class="ttc" id="aactuators_8c_html_ab919c9cf0d6de1c30bb90ee5636f09b8"><div class="ttname"><a href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a></div><div class="ttdeci">actuators_abstraction actuators_state</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8c_source.html#l00031">actuators.c:31</a></div></div>
<div class="ttc" id="alog__utils_8c_html_acf303e3f3f7d320a1113be573509bb63"><div class="ttname"><a href="log__utils_8c.html#acf303e3f3f7d320a1113be573509bb63">log_event</a></div><div class="ttdeci">void log_event(const char *id_aeb, uint32_t event_id, actuators_abstraction actuators)</div><div class="ttdoc">Logs an event to a file with a timestamp and actuator data.</div><div class="ttdef"><b>Definition:</b> <a href="log__utils_8c_source.html#l00025">log_utils.c:25</a></div></div>
<div class="ttc" id="amq__utils_8c_html_abee084f2648925ba92404d2d06f98581"><div class="ttname"><a href="mq__utils_8c.html#abee084f2648925ba92404d2d06f98581">read_mq</a></div><div class="ttdeci">int read_mq(mqd_t mq_receiver, can_msg *msg_read)</div><div class="ttdoc">Reads a message from a POSIX message queue.</div><div class="ttdef"><b>Definition:</b> <a href="mq__utils_8c_source.html#l00099">mq_utils.c:99</a></div></div>
<div class="ttc" id="astructcan__msg_html_ac4e36d6ad06dd50743b62e7414f78184"><div class="ttname"><a href="structcan__msg.html#ac4e36d6ad06dd50743b62e7414f78184">can_msg::identifier</a></div><div class="ttdeci">uint32_t identifier</div><div class="ttdef"><b>Definition:</b> <a href="dbc_8h_source.html#l00048">dbc.h:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a808bc89bdef3d1eb623c526be876d3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a808bc89bdef3d1eb623c526be876d3d8">&#9670;&nbsp;</a></span>actuatorsTranslateCanMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void actuatorsTranslateCanMsg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcan__msg.html">can_msg</a>&#160;</td>
          <td class="paramname"><em>captured_frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00119">119</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">switch</span> (captured_frame.<a class="code" href="structcan__msg.html#ac4e36d6ad06dd50743b62e7414f78184">identifier</a>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="dbc_8h.html#a371988701ce573f2df413957182b8826">ID_AEB_S</a>:</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="actuators_8c.html#a8636c5193582ea95742cd24349cf3aa2">updateInternalActuatorsState</a>(captured_frame);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="dbc_8h.html#aae29e3539bd594d7ade539814febe97b">ID_EMPTY</a>:</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">//printf(&quot;Actuators: Empty message received\n&quot;);</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        printf(<span class="stringliteral">&quot;Actuators: CAN Identifier unknown\n&quot;</span>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="ttc" id="aactuators_8c_html_a8636c5193582ea95742cd24349cf3aa2"><div class="ttname"><a href="actuators_8c.html#a8636c5193582ea95742cd24349cf3aa2">updateInternalActuatorsState</a></div><div class="ttdeci">void updateInternalActuatorsState(can_msg captured_frame)</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8c_source.html#l00135">actuators.c:135</a></div></div>
<div class="ttc" id="adbc_8h_html_a371988701ce573f2df413957182b8826"><div class="ttname"><a href="dbc_8h.html#a371988701ce573f2df413957182b8826">ID_AEB_S</a></div><div class="ttdeci">#define ID_AEB_S</div><div class="ttdef"><b>Definition:</b> <a href="dbc_8h_source.html#l00026">dbc.h:26</a></div></div>
<div class="ttc" id="adbc_8h_html_aae29e3539bd594d7ade539814febe97b"><div class="ttname"><a href="dbc_8h.html#aae29e3539bd594d7ade539814febe97b">ID_EMPTY</a></div><div class="ttdeci">#define ID_EMPTY</div><div class="ttdef"><b>Definition:</b> <a href="dbc_8h_source.html#l00027">dbc.h:27</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00053">53</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="actuators_8c.html#a888ff70e2de4c8fbaedc5134dbe2a441">actuators_mq</a> = <a class="code" href="mq__utils_8c.html#a887671fb12fe2639b7be4a301927e497">open_mq</a>(<a class="code" href="constants_8h.html#ab70848171cb403eb07c6f9e1fecdccd7">ACTUATORS_MQ</a>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">int</span> actuators_thread;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    actuators_thread = pthread_create(&amp;<a class="code" href="actuators_8c.html#ac6b5d6738ab4914747667d9407905730">actuators_id</a>, NULL, <a class="code" href="actuators_8c.html#a2e65ffc061b664d39102b09c560ac7a3">actuatorsResponseLoop</a>, NULL);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span> (actuators_thread != 0)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        perror(<span class="stringliteral">&quot;Actuators: it wasn&#39;t possible to create the associated thread\n&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        exit(54);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    actuators_thread = pthread_join(<a class="code" href="actuators_8c.html#ac6b5d6738ab4914747667d9407905730">actuators_id</a>, NULL);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
<div class="ttc" id="aactuators_8c_html_a2e65ffc061b664d39102b09c560ac7a3"><div class="ttname"><a href="actuators_8c.html#a2e65ffc061b664d39102b09c560ac7a3">actuatorsResponseLoop</a></div><div class="ttdeci">void * actuatorsResponseLoop(void *arg)</div><div class="ttdoc">Main loop for processing actuator messages.</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8c_source.html#l00092">actuators.c:92</a></div></div>
<div class="ttc" id="aactuators_8c_html_ac6b5d6738ab4914747667d9407905730"><div class="ttname"><a href="actuators_8c.html#ac6b5d6738ab4914747667d9407905730">actuators_id</a></div><div class="ttdeci">pthread_t actuators_id</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8c_source.html#l00029">actuators.c:29</a></div></div>
<div class="ttc" id="aconstants_8h_html_ab70848171cb403eb07c6f9e1fecdccd7"><div class="ttname"><a href="constants_8h.html#ab70848171cb403eb07c6f9e1fecdccd7">ACTUATORS_MQ</a></div><div class="ttdeci">#define ACTUATORS_MQ</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00022">constants.h:22</a></div></div>
<div class="ttc" id="amq__utils_8c_html_a887671fb12fe2639b7be4a301927e497"><div class="ttname"><a href="mq__utils_8c.html#a887671fb12fe2639b7be4a301927e497">open_mq</a></div><div class="ttdeci">mqd_t open_mq(char *mq_name)</div><div class="ttdoc">Opens a POSIX message queue.</div><div class="ttdef"><b>Definition:</b> <a href="mq__utils_8c_source.html#l00059">mq_utils.c:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8636c5193582ea95742cd24349cf3aa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8636c5193582ea95742cd24349cf3aa2">&#9670;&nbsp;</a></span>updateInternalActuatorsState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateInternalActuatorsState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcan__msg.html">can_msg</a>&#160;</td>
          <td class="paramname"><em>captured_frame</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00135">135</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (captured_frame.<a class="code" href="structcan__msg.html#ae7f3f34abc69d7ee28fcd77a53091d54">dataFrame</a>[1] == 0x01)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ab7331b3769446808c60936da59a1e3d9">belt_tightness</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#a68e97e44238339a9011a5a1bea267444">door_lock</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ae99ee78e0fedfcef438eca8b2a3e8964">should_activate_abs</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ab6e6f15280e566ecf86f06a780cb94a7">alarm_led</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#afd5b1185a961b17a79fe4fb45a65baa9">alarm_buzzer</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (captured_frame.<a class="code" href="structcan__msg.html#ae7f3f34abc69d7ee28fcd77a53091d54">dataFrame</a>[0] == 0x01)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ab7331b3769446808c60936da59a1e3d9">belt_tightness</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#a68e97e44238339a9011a5a1bea267444">door_lock</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ae99ee78e0fedfcef438eca8b2a3e8964">should_activate_abs</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ab6e6f15280e566ecf86f06a780cb94a7">alarm_led</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#afd5b1185a961b17a79fe4fb45a65baa9">alarm_buzzer</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ab7331b3769446808c60936da59a1e3d9">belt_tightness</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#a68e97e44238339a9011a5a1bea267444">door_lock</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ae99ee78e0fedfcef438eca8b2a3e8964">should_activate_abs</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#ab6e6f15280e566ecf86f06a780cb94a7">alarm_led</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="actuators_8c.html#ab919c9cf0d6de1c30bb90ee5636f09b8">actuators_state</a>.<a class="code" href="structactuators__abstraction.html#afd5b1185a961b17a79fe4fb45a65baa9">alarm_buzzer</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="ttc" id="astructactuators__abstraction_html_a68e97e44238339a9011a5a1bea267444"><div class="ttname"><a href="structactuators__abstraction.html#a68e97e44238339a9011a5a1bea267444">actuators_abstraction::door_lock</a></div><div class="ttdeci">bool door_lock</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8h_source.html#l00009">actuators.h:9</a></div></div>
<div class="ttc" id="astructactuators__abstraction_html_ab6e6f15280e566ecf86f06a780cb94a7"><div class="ttname"><a href="structactuators__abstraction.html#ab6e6f15280e566ecf86f06a780cb94a7">actuators_abstraction::alarm_led</a></div><div class="ttdeci">bool alarm_led</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8h_source.html#l00011">actuators.h:11</a></div></div>
<div class="ttc" id="astructactuators__abstraction_html_ab7331b3769446808c60936da59a1e3d9"><div class="ttname"><a href="structactuators__abstraction.html#ab7331b3769446808c60936da59a1e3d9">actuators_abstraction::belt_tightness</a></div><div class="ttdeci">bool belt_tightness</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8h_source.html#l00008">actuators.h:8</a></div></div>
<div class="ttc" id="astructactuators__abstraction_html_ae99ee78e0fedfcef438eca8b2a3e8964"><div class="ttname"><a href="structactuators__abstraction.html#ae99ee78e0fedfcef438eca8b2a3e8964">actuators_abstraction::should_activate_abs</a></div><div class="ttdeci">bool should_activate_abs</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8h_source.html#l00010">actuators.h:10</a></div></div>
<div class="ttc" id="astructactuators__abstraction_html_afd5b1185a961b17a79fe4fb45a65baa9"><div class="ttname"><a href="structactuators__abstraction.html#afd5b1185a961b17a79fe4fb45a65baa9">actuators_abstraction::alarm_buzzer</a></div><div class="ttdeci">bool alarm_buzzer</div><div class="ttdef"><b>Definition:</b> <a href="actuators_8h_source.html#l00012">actuators.h:12</a></div></div>
<div class="ttc" id="astructcan__msg_html_ae7f3f34abc69d7ee28fcd77a53091d54"><div class="ttname"><a href="structcan__msg.html#ae7f3f34abc69d7ee28fcd77a53091d54">can_msg::dataFrame</a></div><div class="ttdeci">unsigned char dataFrame[8]</div><div class="ttdef"><b>Definition:</b> <a href="dbc_8h_source.html#l00049">dbc.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac6b5d6738ab4914747667d9407905730"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6b5d6738ab4914747667d9407905730">&#9670;&nbsp;</a></span>actuators_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_t actuators_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00029">29</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>

</div>
</div>
<a id="a888ff70e2de4c8fbaedc5134dbe2a441"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a888ff70e2de4c8fbaedc5134dbe2a441">&#9670;&nbsp;</a></span>actuators_mq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mqd_t actuators_mq</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00028">28</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>

</div>
</div>
<a id="ab919c9cf0d6de1c30bb90ee5636f09b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab919c9cf0d6de1c30bb90ee5636f09b8">&#9670;&nbsp;</a></span>actuators_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structactuators__abstraction.html">actuators_abstraction</a> actuators_state</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .belt_tightness = <span class="keyword">false</span>,</div>
<div class="line">    .door_lock = <span class="keyword">true</span>,</div>
<div class="line">    .should_activate_abs = <span class="keyword">false</span>,</div>
<div class="line">    .alarm_led = <span class="keyword">false</span>,</div>
<div class="line">    .alarm_buzzer = <span class="keyword">true</span>}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00031">31</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>

</div>
</div>
<a id="a5d2051893d3d3ea4e0dcc3c647770c95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d2051893d3d3ea4e0dcc3c647770c95">&#9670;&nbsp;</a></span>captured_can_frame</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcan__msg.html">can_msg</a> captured_can_frame</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">    .identifier = 0x0CFFB027,</div>
<div class="line">    .dataFrame = {0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF}}</div>
</div><!-- fragment --><p>Captured CAN message </p>

<p class="definition">Definition at line <a class="el" href="actuators_8c_source.html#l00038">38</a> of file <a class="el" href="actuators_8c_source.html">actuators.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
