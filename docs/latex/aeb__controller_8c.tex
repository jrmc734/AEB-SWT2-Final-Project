\hypertarget{aeb__controller_8c}{}\doxysection{src/aeb\+\_\+controller.c File Reference}
\label{aeb__controller_8c}\index{src/aeb\_controller.c@{src/aeb\_controller.c}}
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$pthread.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include $<$time.\+h$>$}\newline
{\ttfamily \#include \char`\"{}constants.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}mq\+\_\+utils.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}sensors\+\_\+input.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}dbc.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}actuators.\+h\char`\"{}}\newline
Include dependency graph for aeb\+\_\+controller.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{aeb__controller_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{aeb__controller_8c_ab0b4f8f98c3eb2f7041948c148ceadf8}{LOOP\+\_\+\+EMPTY\+\_\+\+ITERATIONS\+\_\+\+MAX}}~11
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}{aeb\+\_\+controller\+\_\+state}} \{ \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928ae454b2a27eae83a0c57bd2ffde66e09a}{AEB\+\_\+\+STATE\+\_\+\+ACTIVE}}
, \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a06edf6bb0f2816cbb0074c27d62e81d4}{AEB\+\_\+\+STATE\+\_\+\+ALARM}}
, \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a9f92c5be6a496ec11dcc37a5740b8bfa}{AEB\+\_\+\+STATE\+\_\+\+BRAKE}}
, \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}{AEB\+\_\+\+STATE\+\_\+\+STANDBY}}
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void $\ast$ \mbox{\hyperlink{aeb__controller_8c_a75689aa11501c348bd09370b739bf2e5}{main\+Working\+Loop}} (void $\ast$arg)
\item 
void \mbox{\hyperlink{aeb__controller_8c_a1243268c621c2049a41956ccfc934fd5}{print\+\_\+info}} ()
\item 
void \mbox{\hyperlink{aeb__controller_8c_aa981d9343b3eb6ab97a07e44dc0e9db5}{translate\+And\+Call\+Can\+Msg}} (\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} captured\+\_\+frame)
\item 
void \mbox{\hyperlink{aeb__controller_8c_a6ba2245e7d2117f6190d0687e1d9beb0}{update\+Internal\+Pedals\+State}} (\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} captured\+\_\+frame)
\item 
void \mbox{\hyperlink{aeb__controller_8c_ac1567ee14cae1132278047c889744010}{update\+Internal\+Speed\+State}} (\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} captured\+\_\+frame)
\item 
void \mbox{\hyperlink{aeb__controller_8c_a6abe9c41325ac131ce28c7922cc509bf}{update\+Internal\+Obstacle\+State}} (\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} captured\+\_\+frame)
\item 
void \mbox{\hyperlink{aeb__controller_8c_a0385dbe57c403b31fa857cced3197a0e}{update\+Internal\+Car\+CState}} (\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} captured\+\_\+frame)
\item 
\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} \mbox{\hyperlink{aeb__controller_8c_a46c3844253eb536d7b9f4a47d0b0e828}{update\+Can\+Msg\+Output}} (\mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}{aeb\+\_\+controller\+\_\+state}} state)
\item 
\mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}{aeb\+\_\+controller\+\_\+state}} \mbox{\hyperlink{aeb__controller_8c_a9e1e44aed4decd88c0903de97e6d2130}{get\+AEBState}} (\mbox{\hyperlink{structsensors__input__data}{sensors\+\_\+input\+\_\+data}} \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\+\_\+internal\+\_\+state}}, int ttc)
\item 
int \mbox{\hyperlink{aeb__controller_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
mqd\+\_\+t \mbox{\hyperlink{aeb__controller_8c_a074b0ef9bc31934bbf9b2b54e9e9aa43}{sensors\+\_\+mq}}
\item 
mqd\+\_\+t \mbox{\hyperlink{aeb__controller_8c_a888ff70e2de4c8fbaedc5134dbe2a441}{actuators\+\_\+mq}}
\item 
pthread\+\_\+t \mbox{\hyperlink{aeb__controller_8c_a31be80dc3d658ca7ba3be24962aed6d4}{aeb\+\_\+controller\+\_\+id}}
\item 
\mbox{\hyperlink{structsensors__input__data}{sensors\+\_\+input\+\_\+data}} \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\+\_\+internal\+\_\+state}}
\item 
\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} \mbox{\hyperlink{aeb__controller_8c_a5d2051893d3d3ea4e0dcc3c647770c95}{captured\+\_\+can\+\_\+frame}}
\item 
\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} \mbox{\hyperlink{aeb__controller_8c_a4847c169e96fc59553ca7c852cc004d6}{out\+\_\+can\+\_\+frame}}
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{aeb__controller_8c_ab0b4f8f98c3eb2f7041948c148ceadf8}\label{aeb__controller_8c_ab0b4f8f98c3eb2f7041948c148ceadf8}} 
\index{aeb\_controller.c@{aeb\_controller.c}!LOOP\_EMPTY\_ITERATIONS\_MAX@{LOOP\_EMPTY\_ITERATIONS\_MAX}}
\index{LOOP\_EMPTY\_ITERATIONS\_MAX@{LOOP\_EMPTY\_ITERATIONS\_MAX}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{LOOP\_EMPTY\_ITERATIONS\_MAX}{LOOP\_EMPTY\_ITERATIONS\_MAX}}
{\footnotesize\ttfamily \#define LOOP\+\_\+\+EMPTY\+\_\+\+ITERATIONS\+\_\+\+MAX~11}



Definition at line 13 of file aeb\+\_\+controller.\+c.



\doxysubsection{Enumeration Type Documentation}
\mbox{\Hypertarget{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}\label{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}} 
\index{aeb\_controller.c@{aeb\_controller.c}!aeb\_controller\_state@{aeb\_controller\_state}}
\index{aeb\_controller\_state@{aeb\_controller\_state}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{aeb\_controller\_state}{aeb\_controller\_state}}
{\footnotesize\ttfamily enum \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}{aeb\+\_\+controller\+\_\+state}}}

\begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{AEB\_STATE\_ACTIVE@{AEB\_STATE\_ACTIVE}!aeb\_controller.c@{aeb\_controller.c}}\index{aeb\_controller.c@{aeb\_controller.c}!AEB\_STATE\_ACTIVE@{AEB\_STATE\_ACTIVE}}}\mbox{\Hypertarget{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928ae454b2a27eae83a0c57bd2ffde66e09a}\label{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928ae454b2a27eae83a0c57bd2ffde66e09a}} 
AEB\+\_\+\+STATE\+\_\+\+ACTIVE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AEB\_STATE\_ALARM@{AEB\_STATE\_ALARM}!aeb\_controller.c@{aeb\_controller.c}}\index{aeb\_controller.c@{aeb\_controller.c}!AEB\_STATE\_ALARM@{AEB\_STATE\_ALARM}}}\mbox{\Hypertarget{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a06edf6bb0f2816cbb0074c27d62e81d4}\label{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a06edf6bb0f2816cbb0074c27d62e81d4}} 
AEB\+\_\+\+STATE\+\_\+\+ALARM&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AEB\_STATE\_BRAKE@{AEB\_STATE\_BRAKE}!aeb\_controller.c@{aeb\_controller.c}}\index{aeb\_controller.c@{aeb\_controller.c}!AEB\_STATE\_BRAKE@{AEB\_STATE\_BRAKE}}}\mbox{\Hypertarget{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a9f92c5be6a496ec11dcc37a5740b8bfa}\label{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a9f92c5be6a496ec11dcc37a5740b8bfa}} 
AEB\+\_\+\+STATE\+\_\+\+BRAKE&\\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{AEB\_STATE\_STANDBY@{AEB\_STATE\_STANDBY}!aeb\_controller.c@{aeb\_controller.c}}\index{aeb\_controller.c@{aeb\_controller.c}!AEB\_STATE\_STANDBY@{AEB\_STATE\_STANDBY}}}\mbox{\Hypertarget{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}\label{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}} 
AEB\+\_\+\+STATE\+\_\+\+STANDBY&\\
\hline

\end{DoxyEnumFields}


Definition at line 15 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{16 \{}
\DoxyCodeLine{17     \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928ae454b2a27eae83a0c57bd2ffde66e09a}{AEB\_STATE\_ACTIVE}},}
\DoxyCodeLine{18     \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a06edf6bb0f2816cbb0074c27d62e81d4}{AEB\_STATE\_ALARM}},}
\DoxyCodeLine{19     \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a9f92c5be6a496ec11dcc37a5740b8bfa}{AEB\_STATE\_BRAKE}},}
\DoxyCodeLine{20     \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}{AEB\_STATE\_STANDBY}}}
\DoxyCodeLine{21 \} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}{aeb\_controller\_state}};}

\end{DoxyCode}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{aeb__controller_8c_a9e1e44aed4decd88c0903de97e6d2130}\label{aeb__controller_8c_a9e1e44aed4decd88c0903de97e6d2130}} 
\index{aeb\_controller.c@{aeb\_controller.c}!getAEBState@{getAEBState}}
\index{getAEBState@{getAEBState}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{getAEBState()}{getAEBState()}}
{\footnotesize\ttfamily \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}{aeb\+\_\+controller\+\_\+state}} get\+AEBState (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structsensors__input__data}{sensors\+\_\+input\+\_\+data}}}]{aeb\+\_\+internal\+\_\+state,  }\item[{int}]{ttc }\end{DoxyParamCaption})}



Definition at line 287 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{288 \{}
\DoxyCodeLine{289     \textcolor{keywordflow}{if} (\mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a7d3eb4bf1acbb1c912830e8808f72168}{on\_off\_aeb\_system}} == \textcolor{keyword}{false})}
\DoxyCodeLine{290         \textcolor{keywordflow}{return} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}{AEB\_STATE\_STANDBY}};}
\DoxyCodeLine{291     \textcolor{keywordflow}{if}(\mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a093ccd15507b18e4a407ae811d01e3ab}{vehicle\_velocity}} < \mbox{\hyperlink{constants_8h_a3f02e1e1a9f7e4eeba4cac6cfe6e18b1}{MIN\_SPD\_ENABLED}} \&\& \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a0f676ac6033e205e2603c48fecf461ef}{reverseEnabled}} == \textcolor{keyword}{false})}
\DoxyCodeLine{292         \textcolor{keywordflow}{return} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}{AEB\_STATE\_STANDBY}};}
\DoxyCodeLine{293     \textcolor{keywordflow}{if} (\mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a093ccd15507b18e4a407ae811d01e3ab}{vehicle\_velocity}} > \mbox{\hyperlink{constants_8h_ad6212b1ad0c34c6212ec01d5aa81005b}{MAX\_SPD\_ENABLED}} \&\& \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a0f676ac6033e205e2603c48fecf461ef}{reverseEnabled}} == \textcolor{keyword}{false})}
\DoxyCodeLine{294         \textcolor{keywordflow}{return} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}{AEB\_STATE\_STANDBY}};}
\DoxyCodeLine{295     \textcolor{keywordflow}{if} (\mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a8cc0d9e6c44c3b22ba0ad4e2e3f7d055}{brake\_pedal}} == \textcolor{keyword}{false} \&\& \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a605d64229c3a536712761f44feb45251}{accelerator\_pedal}} == \textcolor{keyword}{false})}
\DoxyCodeLine{296     \{}
\DoxyCodeLine{297         \textcolor{keywordflow}{if} (ttc < \mbox{\hyperlink{constants_8h_a54bb76eeda8e1910c30bab2500d91325}{THRESHOLD\_BRAKING}})}
\DoxyCodeLine{298             \textcolor{keywordflow}{return} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a9f92c5be6a496ec11dcc37a5740b8bfa}{AEB\_STATE\_BRAKE}};}
\DoxyCodeLine{299         \textcolor{keywordflow}{if} (ttc < \mbox{\hyperlink{constants_8h_af914e188aab1d10dc995ba2938e0b691}{THRESHOLD\_ALARM}})}
\DoxyCodeLine{300             \textcolor{keywordflow}{return} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a06edf6bb0f2816cbb0074c27d62e81d4}{AEB\_STATE\_ALARM}};}
\DoxyCodeLine{301     \}}
\DoxyCodeLine{302     \textcolor{keywordflow}{return} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928ae454b2a27eae83a0c57bd2ffde66e09a}{AEB\_STATE\_ACTIVE}};}
\DoxyCodeLine{303 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}\label{aeb__controller_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}} 
\index{aeb\_controller.c@{aeb\_controller.c}!main@{main}}
\index{main@{main}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 53 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{54 \{}
\DoxyCodeLine{55     \mbox{\hyperlink{aeb__controller_8c_a074b0ef9bc31934bbf9b2b54e9e9aa43}{sensors\_mq}} = \mbox{\hyperlink{mq__utils_8c_a887671fb12fe2639b7be4a301927e497}{open\_mq}}(\mbox{\hyperlink{constants_8h_aab9d8e700a34c08a7d8bca1d5a2d31a5}{SENSORS\_MQ}});}
\DoxyCodeLine{56     \mbox{\hyperlink{aeb__controller_8c_a888ff70e2de4c8fbaedc5134dbe2a441}{actuators\_mq}} = \mbox{\hyperlink{mq__utils_8c_a887671fb12fe2639b7be4a301927e497}{open\_mq}}(\mbox{\hyperlink{constants_8h_ab70848171cb403eb07c6f9e1fecdccd7}{ACTUATORS\_MQ}});}
\DoxyCodeLine{57 }
\DoxyCodeLine{58     \textcolor{keywordtype}{int} controller\_thread = pthread\_create(\&\mbox{\hyperlink{aeb__controller_8c_a31be80dc3d658ca7ba3be24962aed6d4}{aeb\_controller\_id}}, NULL, \mbox{\hyperlink{aeb__controller_8c_a75689aa11501c348bd09370b739bf2e5}{mainWorkingLoop}}, NULL);}
\DoxyCodeLine{59     \textcolor{keywordflow}{if} (controller\_thread != 0)}
\DoxyCodeLine{60     \{}
\DoxyCodeLine{61         perror(\textcolor{stringliteral}{"{}AEB Controller: It wasn't possible to create the associated thread\(\backslash\)n"{}});}
\DoxyCodeLine{62         exit(53);}
\DoxyCodeLine{63     \}}
\DoxyCodeLine{64     controller\_thread = pthread\_join(\mbox{\hyperlink{aeb__controller_8c_a31be80dc3d658ca7ba3be24962aed6d4}{aeb\_controller\_id}}, NULL);}
\DoxyCodeLine{65 }
\DoxyCodeLine{66     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{67 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_a75689aa11501c348bd09370b739bf2e5}\label{aeb__controller_8c_a75689aa11501c348bd09370b739bf2e5}} 
\index{aeb\_controller.c@{aeb\_controller.c}!mainWorkingLoop@{mainWorkingLoop}}
\index{mainWorkingLoop@{mainWorkingLoop}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{mainWorkingLoop()}{mainWorkingLoop()}}
{\footnotesize\ttfamily void $\ast$ main\+Working\+Loop (\begin{DoxyParamCaption}\item[{void $\ast$}]{arg }\end{DoxyParamCaption})}



Definition at line 69 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{70 \{}
\DoxyCodeLine{71     \textcolor{comment}{// Main Loop function for our AEB Controller ECU}}
\DoxyCodeLine{72     \textcolor{comment}{// Step 01: Get CAN frames from the sensors message queue}}
\DoxyCodeLine{73     \textcolor{comment}{// Step 02: Translate the recieved CAN frame, according to its id}}
\DoxyCodeLine{74     \textcolor{comment}{// Step 03: Call the correct Function, based on the new data recieved (o que eh new data recieved? acho que eh a mensagem nova)}}
\DoxyCodeLine{75     \textcolor{comment}{// Step 04: Reactions from the AEB System: based on the new data, what should the AEB controller do?}}
\DoxyCodeLine{76     \textcolor{comment}{// 4.1 -\/ Calculate new ttc}}
\DoxyCodeLine{77     \textcolor{comment}{// 4.2 -\/ Update send\_actuators\_state}}
\DoxyCodeLine{78     \textcolor{comment}{// Should we separate more or can we let everything in this single thread?}}
\DoxyCodeLine{79     \textcolor{comment}{// Will separating things make us need to worry more about synchronization?}}
\DoxyCodeLine{80     \textcolor{comment}{// Step 05: Simple sleep timer? This will change when new functions to fulfill requirements are added}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}{aeb\_controller\_state}} state = \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}{AEB\_STATE\_STANDBY}};}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{keywordtype}{int} empty\_mq\_counter = 0;}
\DoxyCodeLine{85     \textcolor{keywordflow}{while} (empty\_mq\_counter < \mbox{\hyperlink{aeb__controller_8c_ab0b4f8f98c3eb2f7041948c148ceadf8}{LOOP\_EMPTY\_ITERATIONS\_MAX}})}
\DoxyCodeLine{86     \{}
\DoxyCodeLine{87         \textcolor{keywordflow}{if} (\mbox{\hyperlink{mq__utils_8c_abee084f2648925ba92404d2d06f98581}{read\_mq}}(\mbox{\hyperlink{aeb__controller_8c_a074b0ef9bc31934bbf9b2b54e9e9aa43}{sensors\_mq}}, \&\mbox{\hyperlink{aeb__controller_8c_a5d2051893d3d3ea4e0dcc3c647770c95}{captured\_can\_frame}}) != -\/1)}
\DoxyCodeLine{88         \{}
\DoxyCodeLine{89             empty\_mq\_counter = 0; \textcolor{comment}{// reset counter}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91             \mbox{\hyperlink{aeb__controller_8c_aa981d9343b3eb6ab97a07e44dc0e9db5}{translateAndCallCanMsg}}(\mbox{\hyperlink{aeb__controller_8c_a5d2051893d3d3ea4e0dcc3c647770c95}{captured\_can\_frame}});}
\DoxyCodeLine{92 }
\DoxyCodeLine{93             \textcolor{keywordtype}{int} ttc = 1; \textcolor{comment}{// TODO: Calculate TTC here}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95             state = \mbox{\hyperlink{aeb__controller_8c_a9e1e44aed4decd88c0903de97e6d2130}{getAEBState}}(\mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}, ttc);}
\DoxyCodeLine{96             printf(\textcolor{stringliteral}{"{}Meu state eh: \%d\(\backslash\)n"{}}, state);}
\DoxyCodeLine{97 }
\DoxyCodeLine{98             \mbox{\hyperlink{aeb__controller_8c_a4847c169e96fc59553ca7c852cc004d6}{out\_can\_frame}} = \mbox{\hyperlink{aeb__controller_8c_a46c3844253eb536d7b9f4a47d0b0e828}{updateCanMsgOutput}}(state);}
\DoxyCodeLine{99             }
\DoxyCodeLine{100             \mbox{\hyperlink{mq__utils_8c_a57d5de8d149ae20eb2026dac0cef7d08}{write\_mq}}(\mbox{\hyperlink{aeb__controller_8c_a888ff70e2de4c8fbaedc5134dbe2a441}{actuators\_mq}}, \&\mbox{\hyperlink{aeb__controller_8c_a4847c169e96fc59553ca7c852cc004d6}{out\_can\_frame}});}
\DoxyCodeLine{101 }
\DoxyCodeLine{102             \textcolor{comment}{// Testing changes, exclude this on production code}}
\DoxyCodeLine{103             \mbox{\hyperlink{aeb__controller_8c_a1243268c621c2049a41956ccfc934fd5}{print\_info}}();}
\DoxyCodeLine{104         \}}
\DoxyCodeLine{105         \textcolor{keywordflow}{else}}
\DoxyCodeLine{106             empty\_mq\_counter++;}
\DoxyCodeLine{107 }
\DoxyCodeLine{108         usleep(200000); \textcolor{comment}{// Deprecated, change for other function later}}
\DoxyCodeLine{109     \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111     printf(\textcolor{stringliteral}{"{}AEB Controller: Empty MQ counter reached the limit, exiting\(\backslash\)n"{}});}
\DoxyCodeLine{112     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{113 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_a1243268c621c2049a41956ccfc934fd5}\label{aeb__controller_8c_a1243268c621c2049a41956ccfc934fd5}} 
\index{aeb\_controller.c@{aeb\_controller.c}!print\_info@{print\_info}}
\index{print\_info@{print\_info}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{print\_info()}{print\_info()}}
{\footnotesize\ttfamily void print\+\_\+info (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 115 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{116 \{}
\DoxyCodeLine{117     printf(\textcolor{stringliteral}{"{}vehicle\_velocity: \%lf\(\backslash\)n"{}}, \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a093ccd15507b18e4a407ae811d01e3ab}{vehicle\_velocity}});}
\DoxyCodeLine{118     printf(\textcolor{stringliteral}{"{}has\_obstacle: \%s\(\backslash\)n"{}}, \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a3782de9b1037f3ce0036f685de31f165}{has\_obstacle}} ? \textcolor{stringliteral}{"{}true"{}} : \textcolor{stringliteral}{"{}false"{}});}
\DoxyCodeLine{119     printf(\textcolor{stringliteral}{"{}obstacle\_distance: \%lf\(\backslash\)n"{}}, \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a01371737abb4472988490f1d011be0c9}{obstacle\_distance}});}
\DoxyCodeLine{120     printf(\textcolor{stringliteral}{"{}brake\_pedal: \%s\(\backslash\)n"{}}, \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a8cc0d9e6c44c3b22ba0ad4e2e3f7d055}{brake\_pedal}} ? \textcolor{stringliteral}{"{}true"{}} : \textcolor{stringliteral}{"{}false"{}});}
\DoxyCodeLine{121     printf(\textcolor{stringliteral}{"{}accelerator\_pedal: \%s\(\backslash\)n"{}}, \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a605d64229c3a536712761f44feb45251}{accelerator\_pedal}} ? \textcolor{stringliteral}{"{}true"{}} : \textcolor{stringliteral}{"{}false"{}});}
\DoxyCodeLine{122     printf(\textcolor{stringliteral}{"{}on\_off\_aeb\_system: \%s\(\backslash\)n"{}}, \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a7d3eb4bf1acbb1c912830e8808f72168}{on\_off\_aeb\_system}} ? \textcolor{stringliteral}{"{}true"{}} : \textcolor{stringliteral}{"{}false"{}});}
\DoxyCodeLine{123     printf(\textcolor{stringliteral}{"{}Is vehicle in reverse: \%s\(\backslash\)n"{}}, \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a0f676ac6033e205e2603c48fecf461ef}{reverseEnabled}} ? \textcolor{stringliteral}{"{}true"{}} : \textcolor{stringliteral}{"{}false"{}});}
\DoxyCodeLine{124 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_aa981d9343b3eb6ab97a07e44dc0e9db5}\label{aeb__controller_8c_aa981d9343b3eb6ab97a07e44dc0e9db5}} 
\index{aeb\_controller.c@{aeb\_controller.c}!translateAndCallCanMsg@{translateAndCallCanMsg}}
\index{translateAndCallCanMsg@{translateAndCallCanMsg}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{translateAndCallCanMsg()}{translateAndCallCanMsg()}}
{\footnotesize\ttfamily void translate\+And\+Call\+Can\+Msg (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}}}]{captured\+\_\+frame }\end{DoxyParamCaption})}



Definition at line 126 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{127 \{ \textcolor{comment}{// Call aproppriate function to deal with the can\_msg}}
\DoxyCodeLine{128     \textcolor{keywordflow}{switch} (captured\_frame.\mbox{\hyperlink{structcan__msg_ac4e36d6ad06dd50743b62e7414f78184}{identifier}})}
\DoxyCodeLine{129     \{}
\DoxyCodeLine{130     \textcolor{keywordflow}{case} \mbox{\hyperlink{dbc_8h_aba7d5a0a42bbc6b35c9e5ff899fcbb9f}{ID\_PEDALS}}:}
\DoxyCodeLine{131         \mbox{\hyperlink{aeb__controller_8c_a6ba2245e7d2117f6190d0687e1d9beb0}{updateInternalPedalsState}}(captured\_frame);}
\DoxyCodeLine{132         \textcolor{keywordflow}{break};}
\DoxyCodeLine{133     \textcolor{keywordflow}{case} \mbox{\hyperlink{dbc_8h_ae3477def1e243ca2530c658431decd62}{ID\_SPEED\_S}}:}
\DoxyCodeLine{134         \mbox{\hyperlink{aeb__controller_8c_ac1567ee14cae1132278047c889744010}{updateInternalSpeedState}}(captured\_frame);}
\DoxyCodeLine{135         \textcolor{keywordflow}{break};}
\DoxyCodeLine{136     \textcolor{keywordflow}{case} \mbox{\hyperlink{dbc_8h_a1622c4f92373810c870331dfba0ac7c2}{ID\_OBSTACLE\_S}}:}
\DoxyCodeLine{137         \mbox{\hyperlink{aeb__controller_8c_a6abe9c41325ac131ce28c7922cc509bf}{updateInternalObstacleState}}(captured\_frame);}
\DoxyCodeLine{138         \textcolor{keywordflow}{break};}
\DoxyCodeLine{139     \textcolor{keywordflow}{case} \mbox{\hyperlink{dbc_8h_aed7b961aae1393ad39496b0d847580d7}{ID\_CAR\_C}}:}
\DoxyCodeLine{140         \mbox{\hyperlink{aeb__controller_8c_a0385dbe57c403b31fa857cced3197a0e}{updateInternalCarCState}}(captured\_frame);}
\DoxyCodeLine{141         \textcolor{keywordflow}{break};}
\DoxyCodeLine{142     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{143         printf(\textcolor{stringliteral}{"{}CAN Identifier unkown\(\backslash\)n"{}});}
\DoxyCodeLine{144         \textcolor{keywordflow}{break};}
\DoxyCodeLine{145     \}}
\DoxyCodeLine{146 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_a46c3844253eb536d7b9f4a47d0b0e828}\label{aeb__controller_8c_a46c3844253eb536d7b9f4a47d0b0e828}} 
\index{aeb\_controller.c@{aeb\_controller.c}!updateCanMsgOutput@{updateCanMsgOutput}}
\index{updateCanMsgOutput@{updateCanMsgOutput}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{updateCanMsgOutput()}{updateCanMsgOutput()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} update\+Can\+Msg\+Output (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928}{aeb\+\_\+controller\+\_\+state}}}]{state }\end{DoxyParamCaption})}



Definition at line 258 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{259 \{}
\DoxyCodeLine{260     \mbox{\hyperlink{structcan__msg}{can\_msg}} aux = \{.\mbox{\hyperlink{structcan__msg_ac4e36d6ad06dd50743b62e7414f78184}{identifier}} = \mbox{\hyperlink{dbc_8h_a371988701ce573f2df413957182b8826}{ID\_AEB\_S}}, .dataFrame = \mbox{\hyperlink{dbc_8h_af30056253fdd3a5987a1cab7062f7847}{BASE\_DATA\_FRAME}}\};}
\DoxyCodeLine{261 }
\DoxyCodeLine{262     \textcolor{keywordflow}{switch} (state)}
\DoxyCodeLine{263     \{}
\DoxyCodeLine{264         \textcolor{keywordflow}{case} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a9f92c5be6a496ec11dcc37a5740b8bfa}{AEB\_STATE\_BRAKE}}:}
\DoxyCodeLine{265             aux.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] = 0x01; \textcolor{comment}{// activate warning system}}
\DoxyCodeLine{266             aux.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] = 0x01; \textcolor{comment}{// activate braking system}}
\DoxyCodeLine{267             \textcolor{keywordflow}{break};}
\DoxyCodeLine{268         \textcolor{keywordflow}{case} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a06edf6bb0f2816cbb0074c27d62e81d4}{AEB\_STATE\_ALARM}}:}
\DoxyCodeLine{269             aux.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] = 0x01; \textcolor{comment}{// activate warning system}}
\DoxyCodeLine{270             aux.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] = 0x00; \textcolor{comment}{// don't activate braking system}}
\DoxyCodeLine{271             \textcolor{keywordflow}{break};}
\DoxyCodeLine{272         \textcolor{keywordflow}{case} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928ae454b2a27eae83a0c57bd2ffde66e09a}{AEB\_STATE\_ACTIVE}}:}
\DoxyCodeLine{273             aux.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] = 0x00; \textcolor{comment}{// don't activate warning system}}
\DoxyCodeLine{274             aux.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] = 0x00; \textcolor{comment}{// don't activate braking system}}
\DoxyCodeLine{275             \textcolor{keywordflow}{break};}
\DoxyCodeLine{276         \textcolor{keywordflow}{case} \mbox{\hyperlink{aeb__controller_8c_a60d56dbca0466eb23ba7c109132a5928a6d038f8cafa588e741d3b930b758b775}{AEB\_STATE\_STANDBY}}:}
\DoxyCodeLine{277             aux.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] = 0x00; \textcolor{comment}{// don't activate warning system}}
\DoxyCodeLine{278             aux.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] = 0x00; \textcolor{comment}{// don't activate braking system}}
\DoxyCodeLine{279             \textcolor{keywordflow}{break};}
\DoxyCodeLine{280         \textcolor{keywordflow}{default}:}
\DoxyCodeLine{281             \textcolor{keywordflow}{break};}
\DoxyCodeLine{282     \}}
\DoxyCodeLine{283 }
\DoxyCodeLine{284     \textcolor{keywordflow}{return} aux;}
\DoxyCodeLine{285 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_a0385dbe57c403b31fa857cced3197a0e}\label{aeb__controller_8c_a0385dbe57c403b31fa857cced3197a0e}} 
\index{aeb\_controller.c@{aeb\_controller.c}!updateInternalCarCState@{updateInternalCarCState}}
\index{updateInternalCarCState@{updateInternalCarCState}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{updateInternalCarCState()}{updateInternalCarCState()}}
{\footnotesize\ttfamily void update\+Internal\+Car\+CState (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}}}]{captured\+\_\+frame }\end{DoxyParamCaption})}



Definition at line 246 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{247 \{}
\DoxyCodeLine{248     \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] == 0x00)}
\DoxyCodeLine{249     \{}
\DoxyCodeLine{250         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a7d3eb4bf1acbb1c912830e8808f72168}{on\_off\_aeb\_system}} = \textcolor{keyword}{false};}
\DoxyCodeLine{251     \}}
\DoxyCodeLine{252     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] == 0x01)}
\DoxyCodeLine{253     \{}
\DoxyCodeLine{254         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a7d3eb4bf1acbb1c912830e8808f72168}{on\_off\_aeb\_system}} = \textcolor{keyword}{true};}
\DoxyCodeLine{255     \}}
\DoxyCodeLine{256 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_a6abe9c41325ac131ce28c7922cc509bf}\label{aeb__controller_8c_a6abe9c41325ac131ce28c7922cc509bf}} 
\index{aeb\_controller.c@{aeb\_controller.c}!updateInternalObstacleState@{updateInternalObstacleState}}
\index{updateInternalObstacleState@{updateInternalObstacleState}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{updateInternalObstacleState()}{updateInternalObstacleState()}}
{\footnotesize\ttfamily void update\+Internal\+Obstacle\+State (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}}}]{captured\+\_\+frame }\end{DoxyParamCaption})}



Definition at line 208 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{209 \{}
\DoxyCodeLine{210     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} data\_distance; \textcolor{comment}{// used for can frame conversion}}
\DoxyCodeLine{211     \textcolor{keywordtype}{double} new\_internal\_distance = 0.0;}
\DoxyCodeLine{212 }
\DoxyCodeLine{213     \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[2] == 0x00)}
\DoxyCodeLine{214     \{}
\DoxyCodeLine{215         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a3782de9b1037f3ce0036f685de31f165}{has\_obstacle}} = \textcolor{keyword}{false};}
\DoxyCodeLine{216     \}}
\DoxyCodeLine{217     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[2] == 0x01)}
\DoxyCodeLine{218     \{}
\DoxyCodeLine{219         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a3782de9b1037f3ce0036f685de31f165}{has\_obstacle}} = \textcolor{keyword}{true};}
\DoxyCodeLine{220     \}}
\DoxyCodeLine{221 }
\DoxyCodeLine{222     \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] == 0xFF \&\& captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] == 0xFE)}
\DoxyCodeLine{223     \{ \textcolor{comment}{// DBC: Clear Data}}
\DoxyCodeLine{224         \textcolor{comment}{// Defined to max distance, to avoid problems with TTC calculation}}
\DoxyCodeLine{225         new\_internal\_distance = 300.0;}
\DoxyCodeLine{226     \}}
\DoxyCodeLine{227     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] == 0xFF \&\& captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] == 0xFF)}
\DoxyCodeLine{228     \{ \textcolor{comment}{// DBC: Do nothing}}
\DoxyCodeLine{229         ;}
\DoxyCodeLine{230     \}}
\DoxyCodeLine{231     \textcolor{keywordflow}{else}}
\DoxyCodeLine{232     \{}
\DoxyCodeLine{233         \textcolor{comment}{// Conversion from CAN data frame, according to dbc in the requirement file}}
\DoxyCodeLine{234         data\_distance = captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] + (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] << 8);}
\DoxyCodeLine{235         new\_internal\_distance = data\_distance * \mbox{\hyperlink{dbc_8h_ad208b54e7611f9e1696db6646f2b83a1}{RES\_OBSTACLE\_S}};}
\DoxyCodeLine{236     \}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238     \textcolor{keywordflow}{if} (new\_internal\_distance > 300.0)}
\DoxyCodeLine{239     \{ \textcolor{comment}{// DBC: Max value constraint}}
\DoxyCodeLine{240         new\_internal\_distance = 300.0;}
\DoxyCodeLine{241     \}}
\DoxyCodeLine{242 }
\DoxyCodeLine{243     \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a01371737abb4472988490f1d011be0c9}{obstacle\_distance}} = new\_internal\_distance;}
\DoxyCodeLine{244 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_a6ba2245e7d2117f6190d0687e1d9beb0}\label{aeb__controller_8c_a6ba2245e7d2117f6190d0687e1d9beb0}} 
\index{aeb\_controller.c@{aeb\_controller.c}!updateInternalPedalsState@{updateInternalPedalsState}}
\index{updateInternalPedalsState@{updateInternalPedalsState}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{updateInternalPedalsState()}{updateInternalPedalsState()}}
{\footnotesize\ttfamily void update\+Internal\+Pedals\+State (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}}}]{captured\+\_\+frame }\end{DoxyParamCaption})}



Definition at line 148 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{149 \{}
\DoxyCodeLine{150     \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] == 0x00)}
\DoxyCodeLine{151     \{}
\DoxyCodeLine{152         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a605d64229c3a536712761f44feb45251}{accelerator\_pedal}} = \textcolor{keyword}{false};}
\DoxyCodeLine{153     \}}
\DoxyCodeLine{154     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] == 0x01)}
\DoxyCodeLine{155     \{}
\DoxyCodeLine{156         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a605d64229c3a536712761f44feb45251}{accelerator\_pedal}} = \textcolor{keyword}{true};}
\DoxyCodeLine{157     \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159     \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] == 0x00)}
\DoxyCodeLine{160     \{}
\DoxyCodeLine{161         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a8cc0d9e6c44c3b22ba0ad4e2e3f7d055}{brake\_pedal}} = \textcolor{keyword}{false};}
\DoxyCodeLine{162     \}}
\DoxyCodeLine{163     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] == 0x01)}
\DoxyCodeLine{164     \{}
\DoxyCodeLine{165         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a8cc0d9e6c44c3b22ba0ad4e2e3f7d055}{brake\_pedal}} = \textcolor{keyword}{true};}
\DoxyCodeLine{166     \}}
\DoxyCodeLine{167 \}}

\end{DoxyCode}
\mbox{\Hypertarget{aeb__controller_8c_ac1567ee14cae1132278047c889744010}\label{aeb__controller_8c_ac1567ee14cae1132278047c889744010}} 
\index{aeb\_controller.c@{aeb\_controller.c}!updateInternalSpeedState@{updateInternalSpeedState}}
\index{updateInternalSpeedState@{updateInternalSpeedState}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{updateInternalSpeedState()}{updateInternalSpeedState()}}
{\footnotesize\ttfamily void update\+Internal\+Speed\+State (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcan__msg}{can\+\_\+msg}}}]{captured\+\_\+frame }\end{DoxyParamCaption})}



Definition at line 169 of file aeb\+\_\+controller.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{170 \{}
\DoxyCodeLine{171     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} data\_speed; \textcolor{comment}{// used for can frame conversion}}
\DoxyCodeLine{172     \textcolor{keywordtype}{double} new\_internal\_speed = 0.0;}
\DoxyCodeLine{173 }
\DoxyCodeLine{174     \textcolor{comment}{// update internal data according to the relative velocity detected by the sensor}}
\DoxyCodeLine{175     \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] == 0xFE \&\& captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] == 0xFF)}
\DoxyCodeLine{176     \{ \textcolor{comment}{// DBC: Clear Data}}
\DoxyCodeLine{177         new\_internal\_speed = 0.0;}
\DoxyCodeLine{178     \}}
\DoxyCodeLine{179     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] == 0xFF \&\& captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] == 0xFF)}
\DoxyCodeLine{180     \{ \textcolor{comment}{// DBC: Do nothing}}
\DoxyCodeLine{181         ;}
\DoxyCodeLine{182     \}}
\DoxyCodeLine{183     \textcolor{keywordflow}{else}}
\DoxyCodeLine{184     \{}
\DoxyCodeLine{185         \textcolor{comment}{// Conversion from CAN data frame, according to dbc in the requirement file}}
\DoxyCodeLine{186         data\_speed = captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[0] + (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[1] << 8);}
\DoxyCodeLine{187         new\_internal\_speed = data\_speed * \mbox{\hyperlink{dbc_8h_a646c6bfdb7d9573fc91d5d934d37ef43}{RES\_SPEED\_S}};}
\DoxyCodeLine{188     \}}
\DoxyCodeLine{189 }
\DoxyCodeLine{190     \textcolor{keywordflow}{if} (new\_internal\_speed > 251.0)}
\DoxyCodeLine{191     \{ \textcolor{comment}{// DBC: Max value constraint}}
\DoxyCodeLine{192         new\_internal\_speed = 251.0;}
\DoxyCodeLine{193     \}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195     \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a093ccd15507b18e4a407ae811d01e3ab}{vehicle\_velocity}} = new\_internal\_speed;}
\DoxyCodeLine{196 }
\DoxyCodeLine{197     \textcolor{comment}{// update internal data according to the movement direction reported by the sensor}}
\DoxyCodeLine{198     \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[2] == 0x00)}
\DoxyCodeLine{199     \{}
\DoxyCodeLine{200         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a0f676ac6033e205e2603c48fecf461ef}{reverseEnabled}} = \textcolor{keyword}{false};}
\DoxyCodeLine{201     \}}
\DoxyCodeLine{202     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (captured\_frame.\mbox{\hyperlink{structcan__msg_ae7f3f34abc69d7ee28fcd77a53091d54}{dataFrame}}[2] == 0x01)}
\DoxyCodeLine{203     \{}
\DoxyCodeLine{204         \mbox{\hyperlink{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}{aeb\_internal\_state}}.\mbox{\hyperlink{structsensors__input__data_a0f676ac6033e205e2603c48fecf461ef}{reverseEnabled}} = \textcolor{keyword}{true};}
\DoxyCodeLine{205     \}}
\DoxyCodeLine{206 \}}

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{aeb__controller_8c_a888ff70e2de4c8fbaedc5134dbe2a441}\label{aeb__controller_8c_a888ff70e2de4c8fbaedc5134dbe2a441}} 
\index{aeb\_controller.c@{aeb\_controller.c}!actuators\_mq@{actuators\_mq}}
\index{actuators\_mq@{actuators\_mq}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{actuators\_mq}{actuators\_mq}}
{\footnotesize\ttfamily mqd\+\_\+t actuators\+\_\+mq}



Definition at line 33 of file aeb\+\_\+controller.\+c.

\mbox{\Hypertarget{aeb__controller_8c_a31be80dc3d658ca7ba3be24962aed6d4}\label{aeb__controller_8c_a31be80dc3d658ca7ba3be24962aed6d4}} 
\index{aeb\_controller.c@{aeb\_controller.c}!aeb\_controller\_id@{aeb\_controller\_id}}
\index{aeb\_controller\_id@{aeb\_controller\_id}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{aeb\_controller\_id}{aeb\_controller\_id}}
{\footnotesize\ttfamily pthread\+\_\+t aeb\+\_\+controller\+\_\+id}



Definition at line 34 of file aeb\+\_\+controller.\+c.

\mbox{\Hypertarget{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}\label{aeb__controller_8c_a15b2dc1261c867c309a53e7342596884}} 
\index{aeb\_controller.c@{aeb\_controller.c}!aeb\_internal\_state@{aeb\_internal\_state}}
\index{aeb\_internal\_state@{aeb\_internal\_state}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{aeb\_internal\_state}{aeb\_internal\_state}}
{\footnotesize\ttfamily \mbox{\hyperlink{structsensors__input__data}{sensors\+\_\+input\+\_\+data}} aeb\+\_\+internal\+\_\+state}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    .vehicle\_velocity = 0.0,}
\DoxyCodeLine{    .has\_obstacle = \textcolor{keyword}{false},}
\DoxyCodeLine{    .obstacle\_distance = 0.0,}
\DoxyCodeLine{    .brake\_pedal = \textcolor{keyword}{false},}
\DoxyCodeLine{    .accelerator\_pedal = \textcolor{keyword}{false},}
\DoxyCodeLine{    .on\_off\_aeb\_system = \textcolor{keyword}{true},}
\DoxyCodeLine{    .reverseEnabled = \textcolor{keyword}{false}\}}

\end{DoxyCode}


Definition at line 36 of file aeb\+\_\+controller.\+c.

\mbox{\Hypertarget{aeb__controller_8c_a5d2051893d3d3ea4e0dcc3c647770c95}\label{aeb__controller_8c_a5d2051893d3d3ea4e0dcc3c647770c95}} 
\index{aeb\_controller.c@{aeb\_controller.c}!captured\_can\_frame@{captured\_can\_frame}}
\index{captured\_can\_frame@{captured\_can\_frame}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{captured\_can\_frame}{captured\_can\_frame}}
{\footnotesize\ttfamily \mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} captured\+\_\+can\+\_\+frame}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    .identifier = \mbox{\hyperlink{dbc_8h_aed7b961aae1393ad39496b0d847580d7}{ID\_CAR\_C}},}
\DoxyCodeLine{    .dataFrame = \{0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF\}\}}

\end{DoxyCode}


Definition at line 45 of file aeb\+\_\+controller.\+c.

\mbox{\Hypertarget{aeb__controller_8c_a4847c169e96fc59553ca7c852cc004d6}\label{aeb__controller_8c_a4847c169e96fc59553ca7c852cc004d6}} 
\index{aeb\_controller.c@{aeb\_controller.c}!out\_can\_frame@{out\_can\_frame}}
\index{out\_can\_frame@{out\_can\_frame}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{out\_can\_frame}{out\_can\_frame}}
{\footnotesize\ttfamily \mbox{\hyperlink{structcan__msg}{can\+\_\+msg}} out\+\_\+can\+\_\+frame}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{= \{}
\DoxyCodeLine{    .identifier = \mbox{\hyperlink{dbc_8h_a371988701ce573f2df413957182b8826}{ID\_AEB\_S}},}
\DoxyCodeLine{    .dataFrame = \{0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF\}\}}

\end{DoxyCode}


Definition at line 49 of file aeb\+\_\+controller.\+c.

\mbox{\Hypertarget{aeb__controller_8c_a074b0ef9bc31934bbf9b2b54e9e9aa43}\label{aeb__controller_8c_a074b0ef9bc31934bbf9b2b54e9e9aa43}} 
\index{aeb\_controller.c@{aeb\_controller.c}!sensors\_mq@{sensors\_mq}}
\index{sensors\_mq@{sensors\_mq}!aeb\_controller.c@{aeb\_controller.c}}
\doxysubsubsection{\texorpdfstring{sensors\_mq}{sensors\_mq}}
{\footnotesize\ttfamily mqd\+\_\+t sensors\+\_\+mq}



Definition at line 33 of file aeb\+\_\+controller.\+c.

